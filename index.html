
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Генератор актов скрытых работ</title>
  <script src="https://cdn.tailwindcss.com"></script>
<script type="importmap">
{
  "imports": {
    "file-saver": "https://aistudiocdn.com/file-saver@^2.0.5",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.0.4",
    "vite": "https://aistudiocdn.com/vite@^7.1.10",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.25.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "docxtemplater": "https://aistudiocdn.com/docxtemplater@^3.66.7",
    "pizzip": "https://aistudiocdn.com/pizzip@^3.2.0"
  }
}
</script>
<style>
  html, body, #root {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden; /* Prevent browser scrollbars */
  }

  /* Prevent text selection popups by disabling selection globally */
  body {
    -webkit-user-select: none; /* Safari */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* IE 10+ */
    user-select: none; /* Standard syntax */
  }

  /* Re-enable text selection for form inputs and other designated content */
  input,
  textarea,
  [contenteditable="true"],
  .allow-text-selection {
    -webkit-user-select: text; /* Safari */
    -moz-user-select: text; /* Firefox */
    -ms-user-select: text; /* IE 10+ */
    user-select: text; /* Standard syntax */
  }

  .form-checkbox-custom {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      padding: 0;
      -webkit-print-color-adjust: exact;
      color-adjust: exact;
      display: inline-block;
      vertical-align: middle;
      background-origin: border-box;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      flex-shrink: 0;
      color: #2563eb; /* blue-600 */
      background-color: #fff;
      border-color: #94a3b8; /* slate-400 */
      border-width: 1px;
      border-radius: 0.25rem;
  }
  .form-checkbox-custom:focus {
      outline: 2px solid transparent;
      outline-offset: 2px;
      --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);
      --tw-ring-offset-width: 2px;
      --tw-ring-offset-color: #fff;
      --tw-ring-color: #3b82f6; /* blue-500 */
      --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
      --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
      box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
      border-color: #3b82f6; /* blue-500 */
  }
  .form-checkbox-custom:checked {
      border-color: transparent;
      background-color: currentColor;
      background-size: 100% 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
  }

  .form-checkbox-custom.h-5.w-5 {
    height: 1.25rem;
    width: 1.25rem;
  }

  .form-checkbox-custom.h-4.w-4 {
    height: 1rem;
    width: 1rem;
  }
  
  .disable-cell-text-selection {
    user-select: none;
    -webkit-user-select: none;
  }
  
  @keyframes fadeIn-up {
    from {
      opacity: 0;
      transform: translateY(1rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-in-up {
    animation: fadeIn-up 0.3s ease-out forwards;
  }

  @keyframes highlight-row {
    0% { background-color: #fef08a; } /* yellow-200 */
    50% { background-color: #fef9c3; } /* yellow-100 */
    100% { background-color: transparent; }
  }
  
  .animate-highlight {
    animation: highlight-row 2s ease-out forwards;
  }

  @keyframes marching-ants {
    to {
      background-position: 20px 0, -20px 100%, 0 -20px, 100% 20px;
    }
  }

  .copied-cell-overlay {
      position: absolute;
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0;
      pointer-events: none;
      z-index: 30; /* Increased z-index */
      background-image:
          linear-gradient(to right, #2563eb 50%, transparent 50%),
          linear-gradient(to right, #2563eb 50%, transparent 50%),
          linear-gradient(to bottom, #2563eb 50%, transparent 50%),
          linear-gradient(to bottom, #2563eb 50%, transparent 50%);
      background-repeat: repeat-x, repeat-x, repeat-y, repeat-y;
      background-size: 10px 3px, 10px 3px, 3px 10px, 3px 10px; /* Thicker lines */
      background-position: 0 0, 0 100%, 0 0, 100% 0;
      animation: marching-ants 0.25s linear infinite; /* Faster animation */
  }

  .grabbable {
    cursor: grab;
  }

  .grabbable:active {
    cursor: grabbing;
  }

  .drop-target-row-top > td {
      border-top: 2px solid #3b82f6; /* blue-500 */
  }
  .drop-target-row-bottom > td {
      border-bottom: 2px solid #3b82f6; /* blue-500 */
  }

  .act-picker-source-row > td {
      background-color: #fef9c3; /* yellow-100 */
  }
  
  .act-picker-mode tr:not(.act-picker-source-row):hover > td {
      background-color: #dbeafe; /* blue-100 */
      cursor: pointer;
  }

  /* --- Styles for Custom Scrollbar Hiding & Shadows --- */

  /* Hide scrollbar for Chrome, Safari and Opera */
  .no-scrollbar::-webkit-scrollbar {
      display: none;
  }

  /* Hide scrollbar for IE, Edge and Firefox */
  .no-scrollbar {
      -ms-overflow-style: none;  /* IE and Edge */
      scrollbar-width: none;  /* Firefox */
  }

  /* 
     Scroll Shadows Logic:
     Uses background-attachment: local vs scroll to show gradients only when scrolled.
  */
  .scroll-shadows {
      /* Shadow covers (white) */
      background:
          /* Shadow Cover Top */
          linear-gradient(white 30%, rgba(255,255,255,0)),
          /* Shadow Cover Bottom */
          linear-gradient(rgba(255,255,255,0), white 70%) 0 100%,
          /* Shadow Top (Blueish) */
          radial-gradient(farthest-side at 50% 0, rgba(37, 99, 235, 0.4), rgba(0,0,0,0)),
          /* Shadow Bottom (Blueish) */
          radial-gradient(farthest-side at 50% 100%, rgba(37, 99, 235, 0.4), rgba(0,0,0,0)) 0 100%;
      
      background-repeat: no-repeat;
      background-color: white; /* Fallback */
      background-size: 100% 40px, 100% 40px, 100% 14px, 100% 14px;
      
      /* 
         'local' attaches to the content (moves with it). 
         'scroll' attaches to the box (stays fixed).
         When content is scrolled to top, the white 'local' gradient covers the 'scroll' shadow.
      */
      background-attachment: local, local, scroll, scroll;
  }

  /* --- Themes --- */
  
  /* GitHub Dark Theme (Custom Overrides) */
  html.theme-dark body {
      background-color: #0d1117; /* GitHub Dimmed bg */
      color: #c9d1d9; /* GitHub Text Primary */
  }

  /* Reset generic backgrounds for dark mode */
  html.theme-dark .bg-white { background-color: #161b22; color: #c9d1d9; } /* Cards/Panels */
  html.theme-dark .bg-slate-50 { background-color: #0d1117; color: #c9d1d9; } /* App Backgrounds / Table Headers */
  html.theme-dark .bg-slate-100 { background-color: #21262d; color: #c9d1d9; } /* Inputs / Secondary areas */
  html.theme-dark .bg-slate-200 { background-color: #30363d; color: #c9d1d9; } /* Hover states / Borders */
  html.theme-dark .bg-slate-800 { background-color: #010409; } /* Deep dark areas */

  /* Text Colors */
  html.theme-dark .text-slate-900, 
  html.theme-dark .text-slate-800, 
  html.theme-dark .text-gray-900 { color: #f0f6fc; } /* Headings - almost white */
  
  html.theme-dark .text-slate-700,
  html.theme-dark .text-slate-600,
  html.theme-dark .text-gray-700 { color: #c9d1d9; } /* Body text */

  html.theme-dark .text-slate-500,
  html.theme-dark .text-slate-400 { color: #8b949e; } /* Muted text */

  html.theme-dark .text-blue-600, 
  html.theme-dark .text-blue-700 { color: #58a6ff; } /* GitHub Link Blue */
  
  /* Accents */
  html.theme-dark .bg-blue-50 { background-color: rgba(56, 139, 253, 0.1); }
  html.theme-dark .bg-blue-100 { background-color: rgba(56, 139, 253, 0.15); }
  html.theme-dark .bg-blue-600 { background-color: #1f6feb; }
  html.theme-dark .hover\:bg-blue-700:hover { background-color: #388bfd; }
  
  html.theme-dark .bg-green-50 { background-color: rgba(46, 160, 67, 0.1); }
  html.theme-dark .text-green-700, html.theme-dark .text-green-800 { color: #3fb950; }
  html.theme-dark .border-green-200 { border-color: rgba(46, 160, 67, 0.4); }

  html.theme-dark .bg-red-50 { background-color: rgba(248, 81, 73, 0.1); }
  html.theme-dark .text-red-600, html.theme-dark .text-red-700, html.theme-dark .text-red-800 { color: #f85149; }
  html.theme-dark .border-red-200 { border-color: rgba(248, 81, 73, 0.4); }

  /* Borders */
  html.theme-dark .border-slate-100,
  html.theme-dark .border-slate-200,
  html.theme-dark .border-slate-300,
  html.theme-dark .border-gray-200,
  html.theme-dark .border-gray-300 { border-color: #30363d; }
  
  html.theme-dark .divide-slate-200 > :not([hidden]) ~ :not([hidden]) { border-color: #30363d; }

  /* Inputs & Form Elements */
  html.theme-dark input:not([type="checkbox"]), 
  html.theme-dark textarea, 
  html.theme-dark select {
      background-color: #0d1117 !important;
      border-color: #30363d !important;
      color: #c9d1d9 !important;
  }
  html.theme-dark input::placeholder,
  html.theme-dark textarea::placeholder {
      color: #6e7681;
  }
  html.theme-dark input:focus, 
  html.theme-dark textarea:focus, 
  html.theme-dark select:focus {
      border-color: #58a6ff !important;
      box-shadow: 0 0 0 1px #58a6ff !important;
  }

  /* Specific Component Overrides */
  
  /* Sidebar */
  html.theme-dark aside.bg-white {
      background-color: #0d1117;
      border-right: 1px solid #30363d;
  }
  
  /* Buttons (Secondary / Outline) */
  html.theme-dark button.bg-white {
      background-color: #21262d;
      border-color: #363b42;
      color: #c9d1d9;
  }
  html.theme-dark button.bg-white:hover {
      background-color: #30363d;
      border-color: #8b949e;
  }
  
  /* Scroll Shadows correction for dark mode */
  html.theme-dark .scroll-shadows {
      background:
          linear-gradient(#161b22 30%, rgba(22, 27, 34, 0)),
          linear-gradient(rgba(22, 27, 34, 0), #161b22 70%) 0 100%,
          radial-gradient(farthest-side at 50% 0, rgba(56, 139, 253, 0.15), rgba(0,0,0,0)),
          radial-gradient(farthest-side at 50% 100%, rgba(56, 139, 253, 0.15), rgba(0,0,0,0)) 0 100%;
      background-repeat: no-repeat;
      background-color: #161b22;
      background-size: 100% 40px, 100% 40px, 100% 14px, 100% 14px;
      background-attachment: local, local, scroll, scroll;
  }

  /* Table Hover Rows */
  html.theme-dark .hover\:bg-slate-50:hover { background-color: #161b22; }
  
  /* Checkboxes */
  html.theme-dark .form-checkbox-custom {
      background-color: #0d1117;
      border-color: #30363d;
  }
  html.theme-dark .form-checkbox-custom:checked {
      background-color: #1f6feb;
      border-color: #1f6feb;
  }
  
  /* Scrollbars */
  html.theme-dark ::-webkit-scrollbar-track { background: #0d1117; }
  html.theme-dark ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 4px; border: 2px solid #0d1117; }
  html.theme-dark ::-webkit-scrollbar-thumb:hover { background: #8b949e; }

  /* --- Eye Protection Theme (Unchanged) --- */
  html.theme-eye-protection body {
      filter: sepia(0.4) contrast(0.9) brightness(0.95);
      background-color: #fbf1c7;
  }
</style>
</head>
<body class="bg-slate-100 text-slate-800 transition-colors duration-300">
  <div id="root"></div>
  <script type="module" src="/index.tsx"></script>
</body>
</html>
